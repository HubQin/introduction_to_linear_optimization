## 概述

本章旨在介绍**线性规划 (Linear Programming)**。
所谓线性规划，即在满足线性等式与不等式约束的条件下，将一个线性成本函数极小化的问题。

我们将探讨几种等价形式，并辅以若干实例，以此阐明线性规划在广泛场景中的适用性。
同时，我们亦将求解几个简例，从而建立起对问题本质的基本几何直观。

章末将回顾线性代数的相关知识，并说明在描述算法计算需求（即运算量）时的常用惯例。

## **1.1 线性规划问题的变体**

本节旨在阐述线性规划问题，探讨其几种特殊形式，并确立后续通用的标准记号。我们不从抽象概念空谈入手，而是先给出一个具体算例，以便读者理解随后的形式化定义。该例纯粹是为了数学展示，剥离了任何实际背景诠释。至于源于实际场景的案例，我们在 1.2 节中自有充裕的篇幅去展开。

**例 1.1** 下面是一个线性规划问题：

$$
\begin{aligned}
& \text{minimize} & 2x_1 - x_2 + 4x_3 & \\
& \text{subject to} & x_1 + x_2 + x_4 & \le 2 \\
& & 3x_2 - x_3 & = 5 \\
& & x_3 + x_4 & \ge 3 \\
& & x_1 & \ge 0 \\
& & x_3 & \le 0
\end{aligned}
$$

此处，$x_1, x_2, x_3, x_4$ 皆为变量。我们需要选取这些变量的值，在满足一组线性等式与不等式约束的前提下，使线性成本函数 $2x_1 - x_2 + 4x_3$ 达到极小。其中部分约束（如 $x_1 \ge 0$ 和 $x_3 \le 0$）仅是对特定变量符号的简单限制。其余约束则具有 $\mathbf{a}'\mathbf{x} \le b$、$\mathbf{a}'\mathbf{x} = b$ 或 $\mathbf{a}'\mathbf{x} \ge b$ 的形式。此处 $\mathbf{a} = (a_1, a_2, a_3, a_4)$ 为给定向量$^1$，$\mathbf{x} = (x_1, x_2, x_3, x_4)$ 为决策变量向量，$\mathbf{a}'\mathbf{x}$ 为二者的内积 $\sum_{i=1}^4 a_i x_i$，而 $b$ 为给定标量。例如在第一个约束中，$\mathbf{a} = (1, 1, 0, 1)$ 且 $b=2$。

推而广之，在一般的线性规划问题中，给定成本向量 $\mathbf{c} = (c_1, \dots, c_n)$，我们的目标是针对所有 $n$ 维向量 $\mathbf{x} = (x_1, \dots, x_n)$，极小化线性成本函数 $\mathbf{c}'\mathbf{x} = \sum_{i=1}^n c_i x_i$

---

> *注$^1$：正如 1.5 节将进一步详述的，除非另有说明，所有向量均假定为列向量，并在矩阵-向量乘法中依此处理。行向量则表示为（列）向量的转置。不过，在正文中提及向量 $\mathbf{x}$ 时，即便它实为列向量，为了节省篇幅，我们仍采用更俭省的记法 $\mathbf{x} = (x_1, \dots, x_n)$。不熟悉此记号的读者，不妨先参阅 1.5 节再继续阅读。*

需满足一组线性等式与不等式约束。具体而言，设 $M_1, M_2, M_3$ 为有限指标集。对于这些集合中的任意下标 $i$，给定 $n$ 维向量 $\mathbf{a}_i$ 及标量 $b_i$，用以构成第 $i$ 个约束。另设 $N_1$ 与 $N_2$ 为 $\{1, \dots, n\}$ 的子集，分别指明哪些变量 $x_j$ 需满足非负或非正的限制。

于是，我们考察如下问题：

$$
\begin{aligned}
& \text{minimize} & \mathbf{c}'\mathbf{x} & \\
& \text{subject to} & \mathbf{a}_i'\mathbf{x} & \ge b_i, \quad i \in M_1, \\
& & \mathbf{a}_i'\mathbf{x} & \le b_i, \quad i \in M_2, \\
& & \mathbf{a}_i'\mathbf{x} & = b_i, \quad i \in M_3, \\
& & x_j & \ge 0, \quad j \in N_1, \\
& & x_j & \le 0, \quad j \in N_2.
\end{aligned} \quad (1.1)
$$

变量 $x_1, \dots, x_n$ 称为**决策变量**（decision variables），满足所有约束条件的向量 $\mathbf{x}$ 称为**可行解**（feasible solution）或**可行向量**（feasible vector）。所有可行解构成的集合称为**可行集**（feasible set）或**可行域**（feasible region）。

若下标 $j$ 既不属于 $N_1$ 也不属于 $N_2$，则 $x_j$ 的符号不受限制；此时称 $x_j$ 为**自由变量**（free variable）或**无约束变量**（unrestricted variable）。函数 $\mathbf{c}'\mathbf{x}$ 称为**目标函数**（objective function）或**成本函数**（cost function）。

若可行解 $\mathbf{x}^*$ 能使目标函数极小化（即对任意可行解 $\mathbf{x}$，均有 $\mathbf{c}'\mathbf{x}^* \le \mathbf{c}'\mathbf{x}$），则称其为**最优可行解**，或简称**最优解**（optimal solution）。此时 $\mathbf{c}'\mathbf{x}^*$ 的值称为**最优成本**（optimal cost）。

反之，若对任意实数 $K$，总能找到成本小于 $K$ 的可行解 $\mathbf{x}$，则称最优成本为 $-\infty$，或称成本**下无界**（unbounded below）。（有时我们会不严谨地简称该问题**无界**。）

最后需指出，最大化问题无须单独研究，因为最大化 $\mathbf{c}'\mathbf{x}$ 等价于极小化线性成本函数 $-\mathbf{c}'\mathbf{x}$。

一个等式约束 $\mathbf{a}'_i \mathbf{x} = b_i$ 等价于 $\mathbf{a}'_i \mathbf{x} \le b_i$ 与 $\mathbf{a}'_i \mathbf{x} \ge b_i$ 这两个不等式约束。此外，凡形式为 $\mathbf{a}'_i \mathbf{x} \le b_i$ 的约束，皆可改写为 $(-\mathbf{a}_i)' \mathbf{x} \ge -b_i$。最后，$x_j \ge 0$ 或 $x_j \le 0$ 这类约束，亦不过是 $\mathbf{a}'_i \mathbf{x} \ge b_i$ 型约束的特例，此时 $\mathbf{a}_i$ 为单位向量，而 $b_i = 0$。

由此可见，一般线性规划问题的可行集，可完全通过 $\mathbf{a}'_i \mathbf{x} \ge b_i$ 形式的不等式约束来描述。设此类约束共 $m$ 个，下标为 $i = 1, \dots, m$。令 $\mathbf{b} = (b_1, \dots, b_m)$，并设 $\mathbf{A}$ 为一 $m \times n$ 矩阵，其行向量分别为 $\mathbf{a}'_1, \dots, \mathbf{a}'_m$，即：

$$
\mathbf{A} = \begin{bmatrix}
\text{---} & \mathbf{a}'_1 & \text{---} \\
& \vdots & \\
\text{---} & \mathbf{a}'_m & \text{---}
\end{bmatrix}.
$$

于是，约束条件 $\mathbf{a}'_i \mathbf{x} \ge b_i, \ i = 1, \dots, m$，便可紧凑地表示为 $\mathbf{Ax} \ge \mathbf{b}$，而线性规划问题亦可写成如下形式：

$$
\begin{aligned}
& \text{minimize} & \mathbf{c}'\mathbf{x} & \\
& \text{subject to} & \mathbf{Ax} \ge \mathbf{b}.
\end{aligned} \quad (1.2)
$$

诸如 $\mathbf{Ax} \ge \mathbf{b}$ 一类的不等式，一律按**分量**（componentwise）理解；即对于任意 $i$，向量 $\mathbf{Ax}$ 的第 $i$ 个分量（即 $\mathbf{a}'_i\mathbf{x}$），均大于或等于向量 $\mathbf{b}$ 的第 $i$ 个分量 $b_i$。

**例 1.2**  例 1.1 中的线性规划问题可改写如下：

$$
\begin{aligned}
& \text{minimize} & 2x_1 - x_2 + 4x_3 & \\
& \text{subject to} & -x_1 - x_2 \quad\quad - x_4 & \ge -2 \\
& & 3x_2 - x_3 \quad\quad & \ge 5 \\
& & -3x_2 + x_3 \quad\quad & \ge -5 \\
& & x_3 + x_4 & \ge 3 \\
& & x_1 \quad\quad\quad\quad\quad\quad & \ge 0 \\
& & - x_3 \quad\quad & \ge 0,
\end{aligned}
$$

此即问题 (1.2) 所述之形式，其中 $\mathbf{c} = (2, -1, 4, 0)$，

$$
\mathbf{A} = \begin{bmatrix}
-1 & -1 & 0 & -1 \\
0 & 3 & -1 & 0 \\
0 & -3 & 1 & 0 \\
0 & 0 & 1 & 1 \\
1 & 0 & 0 & 0 \\
0 & 0 & -1 & 0
\end{bmatrix},
$$

且 $\mathbf{b} = (-2, 5, -5, 3, 0, 0)$。

**标准型问题**

若线性规划问题具有如下形式：

$$
\begin{aligned}
& \text{minimize} & \mathbf{c}'\mathbf{x} & \\
& \text{subject to} & \mathbf{Ax} & = \mathbf{b} \quad (1.3) \\
& & \mathbf{x} & \ge \mathbf{0},
\end{aligned}
$$

则称其为**标准型**（standard form）。在此，我们对标准型问题给出一个直观解释。设 $\mathbf{x}$ 的维数为 $n$，且 $\mathbf{A}_1, \dots, \mathbf{A}_n$ 为矩阵 $\mathbf{A}$ 的列向量。于是，约束条件 $\mathbf{Ax} = \mathbf{b}$ 可写为如下形式：

$$
\sum_{i=1}^n \mathbf{A}_i x_i = \mathbf{b}.
$$

直观上看，假设现有 $n$ 种可用的资源向量 $\mathbf{A}_1, \dots, \mathbf{A}_n$，以及一个目标向量 $\mathbf{b}$。我们希望利用非负数量 $x_i$ 的每种资源向量 $\mathbf{A}_i$ 来“合成”目标向量 $\mathbf{b}$，同时使总成本 $\sum_{i=1}^n c_i x_i$ 最小，其中 $c_i$ 为第 $i$ 种资源的单位成本。下面举一个更具体的例子。

**例 1.3 (饮食问题)** 设共有 $n$ 种不同的食物和 $m$ 种不同的营养素。下表列出了每单位各种食物所含的营养成分：

$$
\begin{array}{c|ccc}
& \text{食物 } 1 & \cdots & \text{食物 } n \\
\hline
\text{营养素 } 1 & a_{11} & \cdots & a_{1n} \\
\vdots & \vdots & & \vdots \\
\text{营养素 } m & a_{m1} & \cdots & a_{mn}
\end{array}
$$

令 $\mathbf{A}$ 为由元素 $a_{ij}$ 构成的 $m \times n$ 矩阵。请注意，该矩阵的第 $j$ 列 $\mathbf{A}_j$ 代表了第 $j$ 种食物的营养成分。令向量 $\mathbf{b}$ 表示理想饮食的需求，或者等价地，将其视为一种“理想食物”的营养规格。

于是，我们可以将标准型问题理解为：通过混合非负数量 $x_i$ 的现有食物，以最小的成本“合成”出这种理想食物。在此问题的一个变体中，向量 $\mathbf{b}$ 规定的是一套合格饮食的**最低**需求；在那样的情形下，约束 $\mathbf{Ax} = \mathbf{b}$ 被替换为 $\mathbf{Ax} \ge \mathbf{b}$，该问题也就不再属于标准型了。

**化为标准型**

如前所述，任何线性规划问题，包括标准型问题 (1.3)，皆为一般形式 (1.1) 的特例。现欲说明，反之亦然：一般线性规划问题亦可转化为等价的标准型问题。

此处所谓“等价”，意指若给定其中一问题的可行解，便可构造出另一问题的可行解，且两者成本相同。具体而言，两问题的最优成本相同，且给定其一的最优解，即可构造出另一问题的最优解。

这种转化包含如下两个步骤：

(a) **消除自由变量**：对于一般形式问题中的无约束变量 $x_j$，将其替换为 $x_j^+ - x_j^-$，其中 $x_j^+$ 与 $x_j^-$ 为新引入的变量，并施加符号约束 $x_j^+ \ge 0$ 及 $x_j^- \ge 0$。其背后的原理在于，任何实数皆可写成两个非负数之差。

(b) **消除不等式约束**：对于形式为

$$
\sum_{j=1}^n a_{ij}x_j \le b_i
$$

的不等式约束，我们引入一个新变量 $s_i$，并将约束写为如下标准型：

$$
\begin{aligned}
\sum_{j=1}^n a_{ij}x_j + s_i &= b_i, \\
s_i &\ge 0.
\end{aligned}
$$

此类变量 $s_i$ 称为**松弛变量**（slack variable）。同理，对于 $\sum_{j=1}^n a_{ij}x_j \ge b_i$ 形式的不等式约束，亦可通过引入**剩余变量**（surplus variable）$s_i$ 及约束 $\sum_{j=1}^n a_{ij}x_j - s_i = b_i, \ s_i \ge 0$ 将其化为标准型。

综上所述，一般问题皆可化为标准型。因此，我们仅需开发求解标准型问题的方法即可。

**例 1.4** 考虑如下问题：

$$
\begin{aligned}
& \text{minimize} & 2x_1 + 4x_2 & \\
& \text{subject to} & x_1 + x_2 & \ge 3 \\
& & 3x_1 + 2x_2 & = 14 \\
& & x_1 \quad\quad & \ge 0,
\end{aligned}
$$

其等价于如下标准型问题：

$$
\begin{aligned}
& \text{minimize} & 2x_1 + 4x_2^+ - 4x_2^- & \\
& \text{subject to} & x_1 + x_2^+ - x_2^- - x_3 & = 3 \\
& & 3x_1 + 2x_2^+ - 2x_2^- \quad\quad & = 14 \\
& & x_1, x_2^+, x_2^-, x_3 & \ge 0.
\end{aligned}
$$

例如，给定原问题的一个可行解 $(x_1, x_2) = (6, -2)$，我们可得标准型问题的可行解 $(x_1, x_2^+, x_2^-, x_3) = (6, 0, 2, 1)$，且两者成本相同。反之，给定标准型问题的可行解 $(x_1, x_2^+, x_2^-, x_3) = (8, 1, 6, 0)$，我们亦可得原问题的可行解 $(x_1, x_2) = (8, -5)$，成本依然相同。

后文中，我们将常以一般形式 $\mathbf{Ax} \ge \mathbf{b}$ 来阐述线性规划理论。然而，在涉及算法（特别是单纯形法与内点法）时，我们将聚焦于标准型 $\mathbf{Ax} = \mathbf{b}, \mathbf{x} \ge \mathbf{0}$，因其在计算上更为便易。


## **1.2 线性规划问题举例**

在本节中，我们将探讨若干线性规划问题的实例。我们的目的之一，是展示线性规划有着极为广泛的适用场景。另一目的，则是帮助读者熟悉那门将定义松散的优化问题构建为数学模型的艺术。

### **生产问题**

某企业利用 $m$ 种不同的原料，生产 $n$ 种不同的产品。令 $b_i$ ($i = 1, \dots, m$) 表示第 $i$ 种原料的现有存量。生产单位第 $j$ 种产品 ($j = 1, \dots, n$)，需消耗 $a_{ij}$ 单位的第 $i$ 种原料，并产生 $c_j$ 的收益。该企业面临的问题是：如何确定每种产品的产量，以使总收益最大化。

本例中，决策变量的选取显而易见。令 $x_j$ ($j = 1, \dots, n$) 表示第 $j$ 种产品的产量。于是，该企业的生产问题可建模如下：

$$
\begin{aligned}
& \text{maximize} & c_1 x_1 + \cdots + c_n x_n & \\
& \text{subject to} & a_{i1} x_1 + \cdots + a_{in} x_n & \le b_i, \quad & i = 1, \dots, m, \\
& & x_j & \ge 0, \quad & j = 1, \dots, n.
\end{aligned}
$$


### **计算机厂商的生产规划**

此处探讨之例，源于数字设备公司（DEC）在 1988 年第四季度的亲身遭遇。此例不仅揭示了现实应用的错综复杂与变幻莫测，更彰显了数学建模在制定重大战略决策时的实用价值。

1988 年二季度，DEC 推出了一系列全新的（单 CPU）计算机系统与工作站。其中，GP-1、GP-2 和 GP-3 为通用计算机系统，在内存、磁盘存储及扩展能力上各不相同；WS-1 和 WS-2 则为工作站。表 1.1 列出了各型号的标价、单机平均磁盘用量及内存用量。譬如，GP-1 需使用 4 块 256K 内存板，且每生产 10 台，平均有 3 台配有磁盘驱动器（即 0.3 的平均用量）。


| 系统型号 (System) | 价格 (Price) | 磁盘驱动器数量 (# disk drives) | 256K 内存板数量 (# 256K boards) |
| :---------------- | :----------- | :----------------------------- | :------------------------------ |
| **GP-1**          | $60,000      | 0.3                            | 4                               |
| **GP-2**          | $40,000      | 1.7                            | 2                               |
| **GP-3**          | $30,000      | 0                              | 2                               |
| **WS-1**          | $30,000      | 1.4                            | 2                               |
| **WS-2**          | $15,000      | 0                              | 1                               |

**表 1.1：DEC 五种不同系统的特性**

该系列新品于第三季度开始发货，并在第四季度缓慢增量。然而，预计下一季度将面临如下困境：

(a) 受调试问题所限，内部 CPU 供应商最多仅能提供 7,000 套。
(b) 磁盘驱动器的供应尚存变数，制造商预估其供应量在 3,000 至 7,000 台之间。
(c) 256K 内存板的供应同样受限，数量介于 8,000 至 16,000 块之间。

在需求方面，市场部确立了 1989 年第一季度的最大需求量：GP-1 系统为 1,800 台，GP-3 系统为 300 台，GP 全系列总计 3,800 台，WS 系列总计 3,200 台。上述预测包含了已接获并须在下一季度交付的订单：GP-2 为 500 台，WS-1 为 500 台，WS-2 为 400 台。

在前几个季度，为应对磁盘驱动器短缺，DEC 采取了如下生产策略：GP-1、GP-3 和 WS-2 不配磁盘驱动器（尽管每 10 位 GP-1 客户中有 3 位希望配置），而 GP-2 和 WS-1 仅配 1 个磁盘驱动器。我们将这种系统配置方式称为**受限生产模式** (constrained mode of production)。

此外，DEC 可通过在 GP-1 系统中使用 2 块替代存储板来取代 4 块 256K 内存板，以此缓解 256K 内存板的短缺。DEC 下一季度可提供 4,000 块替代板。

制造部门清楚地意识到问题已变得错综复杂，营收、利润及客户满意度皆面临风险。如下决策亟待制定：

(a) 1989 年第一季度的生产计划。
(b) 关于磁盘驱动器的使用，DEC 应继续沿用受限模式生产，还是计划满足客户偏好？
(c) 关于内存板，DEC 是否应在其 GP-1 系统中使用替代内存板？
(d) 最后一项决策事关磁盘驱动器短缺与 256K 内存板短缺之间的权衡。制造人员希望集中精力缓解磁盘短缺或 256K 内存板短缺（二者选一）。因此，他们想知道哪一种选择对营收的影响更大。

为了对 DEC 面临的问题进行建模，我们引入变量 $x_1, x_2, x_3, x_4, x_5$，分别代表下一季度计划生产的 GP-1, GP-2, GP-3, WS-1, 和 WS-2 系统的数量（单位：千台）。严格来说，由于 $1000x_i$ 代表产品台数，它必须是整数。这可以通过保留 $x_i$ 小数点后三位（即截断后续小数）来实现；考虑到需求规模以及变量 $x_i$ 的量级，这种取整造成的影响微乎其微，因此可以忽略 $1000x_i$ 的整数约束。

DEC 面临着两项截然不同的决策：其一，在磁盘驱动器的使用上是否采用受限生产模式；其二，对于 GP-1 系统是否使用替代内存板。这导致了四种可能的决策组合。

首先，针对**不使用**替代内存板且**采用**受限磁盘生产模式的情形，我们建立如下模型：

$$
\text{最大化} \quad 60x_1 + 40x_2 + 30x_3 + 30x_4 + 15x_5 \quad (\text{总营收})
$$

满足下列约束：

$$
\begin{aligned}
x_1 + x_2 + x_3 + x_4 + x_5 & \le 7 & & (\text{CPU 供应量}) \\
4x_1 + 2x_2 + 2x_3 + 2x_4 + x_5 & \le 8 & & (\text{256K 内存供应量}) \\
x_2 \quad\quad + x_4 \quad\quad & \le 3 & & (\text{磁盘驱动器供应量}) \\
x_1 \quad\quad\quad\quad\quad\quad\quad\quad & \le 1.8 & & (\text{GP-1 最大需求}) \\
x_3 \quad\quad\quad\quad & \le 0.3 & & (\text{GP-3 最大需求}) \\
x_1 + x_2 + x_3 \quad\quad\quad\quad & \le 3.8 & & (\text{GP 系列最大需求}) \\
x_4 + x_5 & \le 3.2 & & (\text{WS 系列最大需求}) \\
x_2 \quad\quad\quad\quad\quad\quad & \ge 0.5 & & (\text{GP-2 最小需求}) \\
x_4 \quad\quad & \ge 0.5 & & (\text{WS-1 最小需求}) \\
x_5 & \ge 0.4 & & (\text{WS-2 最小需求}) \\
x_1, x_2, x_3, x_4, x_5 & \ge 0. & &
\end{aligned}
$$

请注意，目标函数的单位是百万美元。从某些方面看，这是一个**悲观**的建模，因为 256K 内存和磁盘驱动器的供应量分别被设定为 8 和 3，这是预估范围的下限。实际上，考察当 256K 内存供应量在 8 到 16 之间变化、磁盘供应量在 3 到 7 之间变化时该问题的解，是很有意义的，因为这能提供关于最优解对供应量**敏感性**的宝贵信息。而在另一方面，该建模又是**乐观**的，例如，它假设只要 $x_1 \le 1.8$，GP-1 系统带来的收入就是 $60x_1$，尽管实际上 1,800 台 GP-1 的需求并非板上钉钉。

为了涵盖 DEC 拥有的其他三种选择，部分约束条件需做如下修改。若我们对磁盘驱动器采用**非受限**生产模式，则约束 $x_2 + x_4 \le 3$ 需替换为：

$$
0.3x_1 + 1.7x_2 + 1.4x_4 \le 3.
$$

此外，若我们希望在 GP-1 系统中使用**替代内存板**，则需将约束 $4x_1 + 2x_2 + 2x_3 + 2x_4 + x_5 \le 8$ 替换为以下两个约束：

$$
\begin{aligned}
2x_1 \quad\quad\quad\quad\quad\quad & \le 4, \\
2x_2 + 2x_3 + 2x_4 + x_5 & \le 8.
\end{aligned}
$$

这四种选择的组合，引出了四个各异的线性规划问题。由于如前所述，部分约束条件右端项的确切数值尚不可知，仅知其处于一定范围内，因此对于这每一个问题，都需针对多种参数取值分别求解。

第 5 章将专门探讨当特定参数发生变动时求解线性规划问题的方法，届时我们将重访这一案例。
