## 概述

本章旨在介绍**线性规划 (Linear Programming)**。
所谓线性规划，即在满足线性等式与不等式约束的条件下，将一个线性成本函数极小化的问题。

我们将探讨几种等价形式，并辅以若干实例，以此阐明线性规划在广泛场景中的适用性。
同时，我们亦将求解几个简例，从而建立起对问题本质的基本几何直观。

章末将回顾线性代数的相关知识，并说明在描述算法计算需求（即运算量）时的常用惯例。

## **1.1 线性规划问题的变体**

本节旨在阐述线性规划问题，探讨其几种特殊形式，并确立后续通用的标准记号。我们不从抽象概念空谈入手，而是先给出一个具体算例，以便读者理解随后的形式化定义。该例纯粹是为了数学展示，剥离了任何实际背景诠释。至于源于实际场景的案例，我们在 1.2 节中自有充裕的篇幅去展开。

**例 1.1** 下面是一个线性规划问题：

$$
\begin{aligned}
& \text{minimize} & 2x_1 - x_2 + 4x_3 & \\
& \text{subject to} & x_1 + x_2 + x_4 & \le 2 \\
& & 3x_2 - x_3 & = 5 \\
& & x_3 + x_4 & \ge 3 \\
& & x_1 & \ge 0 \\
& & x_3 & \le 0
\end{aligned}
$$

此处，$x_1, x_2, x_3, x_4$ 皆为变量。我们需要选取这些变量的值，在满足一组线性等式与不等式约束的前提下，使线性成本函数 $2x_1 - x_2 + 4x_3$ 达到极小。其中部分约束（如 $x_1 \ge 0$ 和 $x_3 \le 0$）仅是对特定变量符号的简单限制。其余约束则具有 $\mathbf{a}'\mathbf{x} \le b$、$\mathbf{a}'\mathbf{x} = b$ 或 $\mathbf{a}'\mathbf{x} \ge b$ 的形式。此处 $\mathbf{a} = (a_1, a_2, a_3, a_4)$ 为给定向量$^1$，$\mathbf{x} = (x_1, x_2, x_3, x_4)$ 为决策变量向量，$\mathbf{a}'\mathbf{x}$ 为二者的内积 $\sum_{i=1}^4 a_i x_i$，而 $b$ 为给定标量。例如在第一个约束中，$\mathbf{a} = (1, 1, 0, 1)$ 且 $b=2$。

推而广之，在一般的线性规划问题中，给定成本向量 $\mathbf{c} = (c_1, \dots, c_n)$，我们的目标是针对所有 $n$ 维向量 $\mathbf{x} = (x_1, \dots, x_n)$，极小化线性成本函数 $\mathbf{c}'\mathbf{x} = \sum_{i=1}^n c_i x_i$

---

> *注$^1$：正如 1.5 节将进一步详述的，除非另有说明，所有向量均假定为列向量，并在矩阵-向量乘法中依此处理。行向量则表示为（列）向量的转置。不过，在正文中提及向量 $\mathbf{x}$ 时，即便它实为列向量，为了节省篇幅，我们仍采用更俭省的记法 $\mathbf{x} = (x_1, \dots, x_n)$。不熟悉此记号的读者，不妨先参阅 1.5 节再继续阅读。*

需满足一组线性等式与不等式约束。具体而言，设 $M_1, M_2, M_3$ 为有限指标集。对于这些集合中的任意下标 $i$，给定 $n$ 维向量 $\mathbf{a}_i$ 及标量 $b_i$，用以构成第 $i$ 个约束。另设 $N_1$ 与 $N_2$ 为 $\{1, \dots, n\}$ 的子集，分别指明哪些变量 $x_j$ 需满足非负或非正的限制。

于是，我们考察如下问题：

$$
\begin{aligned}
& \text{minimize} & \mathbf{c}'\mathbf{x} & \\
& \text{subject to} & \mathbf{a}_i'\mathbf{x} & \ge b_i, \quad i \in M_1, \\
& & \mathbf{a}_i'\mathbf{x} & \le b_i, \quad i \in M_2, \\
& & \mathbf{a}_i'\mathbf{x} & = b_i, \quad i \in M_3, \\
& & x_j & \ge 0, \quad j \in N_1, \\
& & x_j & \le 0, \quad j \in N_2.
\end{aligned} \quad (1.1)
$$

变量 $x_1, \dots, x_n$ 称为**决策变量**（decision variables），满足所有约束条件的向量 $\mathbf{x}$ 称为**可行解**（feasible solution）或**可行向量**（feasible vector）。所有可行解构成的集合称为**可行集**（feasible set）或**可行域**（feasible region）。

若下标 $j$ 既不属于 $N_1$ 也不属于 $N_2$，则 $x_j$ 的符号不受限制；此时称 $x_j$ 为**自由变量**（free variable）或**无约束变量**（unrestricted variable）。函数 $\mathbf{c}'\mathbf{x}$ 称为**目标函数**（objective function）或**成本函数**（cost function）。

若可行解 $\mathbf{x}^*$ 能使目标函数极小化（即对任意可行解 $\mathbf{x}$，均有 $\mathbf{c}'\mathbf{x}^* \le \mathbf{c}'\mathbf{x}$），则称其为**最优可行解**，或简称**最优解**（optimal solution）。此时 $\mathbf{c}'\mathbf{x}^*$ 的值称为**最优成本**（optimal cost）。

反之，若对任意实数 $K$，总能找到成本小于 $K$ 的可行解 $\mathbf{x}$，则称最优成本为 $-\infty$，或称成本**下无界**（unbounded below）。（有时我们会不严谨地简称该问题**无界**。）

最后需指出，最大化问题无须单独研究，因为最大化 $\mathbf{c}'\mathbf{x}$ 等价于极小化线性成本函数 $-\mathbf{c}'\mathbf{x}$。

一个等式约束 $\mathbf{a}'_i \mathbf{x} = b_i$ 等价于 $\mathbf{a}'_i \mathbf{x} \le b_i$ 与 $\mathbf{a}'_i \mathbf{x} \ge b_i$ 这两个不等式约束。此外，凡形式为 $\mathbf{a}'_i \mathbf{x} \le b_i$ 的约束，皆可改写为 $(-\mathbf{a}_i)' \mathbf{x} \ge -b_i$。最后，$x_j \ge 0$ 或 $x_j \le 0$ 这类约束，亦不过是 $\mathbf{a}'_i \mathbf{x} \ge b_i$ 型约束的特例，此时 $\mathbf{a}_i$ 为单位向量，而 $b_i = 0$。

由此可见，一般线性规划问题的可行集，可完全通过 $\mathbf{a}'_i \mathbf{x} \ge b_i$ 形式的不等式约束来描述。设此类约束共 $m$ 个，下标为 $i = 1, \dots, m$。令 $\mathbf{b} = (b_1, \dots, b_m)$，并设 $\mathbf{A}$ 为一 $m \times n$ 矩阵，其行向量分别为 $\mathbf{a}'_1, \dots, \mathbf{a}'_m$，即：

$$
\mathbf{A} = \begin{bmatrix}
\text{---} & \mathbf{a}'_1 & \text{---} \\
& \vdots & \\
\text{---} & \mathbf{a}'_m & \text{---}
\end{bmatrix}.
$$

于是，约束条件 $\mathbf{a}'_i \mathbf{x} \ge b_i, \ i = 1, \dots, m$，便可紧凑地表示为 $\mathbf{Ax} \ge \mathbf{b}$，而线性规划问题亦可写成如下形式：

$$
\begin{aligned}
& \text{minimize} & \mathbf{c}'\mathbf{x} & \\
& \text{subject to} & \mathbf{Ax} \ge \mathbf{b}.
\end{aligned} \quad (1.2)
$$

诸如 $\mathbf{Ax} \ge \mathbf{b}$ 一类的不等式，一律按**分量**（componentwise）理解；即对于任意 $i$，向量 $\mathbf{Ax}$ 的第 $i$ 个分量（即 $\mathbf{a}'_i\mathbf{x}$），均大于或等于向量 $\mathbf{b}$ 的第 $i$ 个分量 $b_i$。

**例 1.2**  例 1.1 中的线性规划问题可改写如下：

$$
\begin{aligned}
& \text{minimize} & 2x_1 - x_2 + 4x_3 & \\
& \text{subject to} & -x_1 - x_2 \quad\quad - x_4 & \ge -2 \\
& & 3x_2 - x_3 \quad\quad & \ge 5 \\
& & -3x_2 + x_3 \quad\quad & \ge -5 \\
& & x_3 + x_4 & \ge 3 \\
& & x_1 \quad\quad\quad\quad\quad\quad & \ge 0 \\
& & - x_3 \quad\quad & \ge 0,
\end{aligned}
$$

此即问题 (1.2) 所述之形式，其中 $\mathbf{c} = (2, -1, 4, 0)$，

$$
\mathbf{A} = \begin{bmatrix}
-1 & -1 & 0 & -1 \\
0 & 3 & -1 & 0 \\
0 & -3 & 1 & 0 \\
0 & 0 & 1 & 1 \\
1 & 0 & 0 & 0 \\
0 & 0 & -1 & 0
\end{bmatrix},
$$

且 $\mathbf{b} = (-2, 5, -5, 3, 0, 0)$。

**标准型问题**

若线性规划问题具有如下形式：

$$
\begin{aligned}
& \text{minimize} & \mathbf{c}'\mathbf{x} & \\
& \text{subject to} & \mathbf{Ax} & = \mathbf{b} \quad (1.3) \\
& & \mathbf{x} & \ge \mathbf{0},
\end{aligned}
$$

则称其为**标准型**（standard form）。在此，我们对标准型问题给出一个直观解释。设 $\mathbf{x}$ 的维数为 $n$，且 $\mathbf{A}_1, \dots, \mathbf{A}_n$ 为矩阵 $\mathbf{A}$ 的列向量。于是，约束条件 $\mathbf{Ax} = \mathbf{b}$ 可写为如下形式：

$$
\sum_{i=1}^n \mathbf{A}_i x_i = \mathbf{b}.
$$

直观上看，假设现有 $n$ 种可用的资源向量 $\mathbf{A}_1, \dots, \mathbf{A}_n$，以及一个目标向量 $\mathbf{b}$。我们希望利用非负数量 $x_i$ 的每种资源向量 $\mathbf{A}_i$ 来“合成”目标向量 $\mathbf{b}$，同时使总成本 $\sum_{i=1}^n c_i x_i$ 最小，其中 $c_i$ 为第 $i$ 种资源的单位成本。下面举一个更具体的例子。

**例 1.3 (饮食问题)** 设共有 $n$ 种不同的食物和 $m$ 种不同的营养素。下表列出了每单位各种食物所含的营养成分：

$$
\begin{array}{c|ccc}
& \text{食物 } 1 & \cdots & \text{食物 } n \\
\hline
\text{营养素 } 1 & a_{11} & \cdots & a_{1n} \\
\vdots & \vdots & & \vdots \\
\text{营养素 } m & a_{m1} & \cdots & a_{mn}
\end{array}
$$

令 $\mathbf{A}$ 为由元素 $a_{ij}$ 构成的 $m \times n$ 矩阵。请注意，该矩阵的第 $j$ 列 $\mathbf{A}_j$ 代表了第 $j$ 种食物的营养成分。令向量 $\mathbf{b}$ 表示理想饮食的需求，或者等价地，将其视为一种“理想食物”的营养规格。

于是，我们可以将标准型问题理解为：通过混合非负数量 $x_i$ 的现有食物，以最小的成本“合成”出这种理想食物。在此问题的一个变体中，向量 $\mathbf{b}$ 规定的是一套合格饮食的**最低**需求；在那样的情形下，约束 $\mathbf{Ax} = \mathbf{b}$ 被替换为 $\mathbf{Ax} \ge \mathbf{b}$，该问题也就不再属于标准型了。

**化为标准型**

如前所述，任何线性规划问题，包括标准型问题 (1.3)，皆为一般形式 (1.1) 的特例。现欲说明，反之亦然：一般线性规划问题亦可转化为等价的标准型问题。

此处所谓“等价”，意指若给定其中一问题的可行解，便可构造出另一问题的可行解，且两者成本相同。具体而言，两问题的最优成本相同，且给定其一的最优解，即可构造出另一问题的最优解。

这种转化包含如下两个步骤：

(a) **消除自由变量**：对于一般形式问题中的无约束变量 $x_j$，将其替换为 $x_j^+ - x_j^-$，其中 $x_j^+$ 与 $x_j^-$ 为新引入的变量，并施加符号约束 $x_j^+ \ge 0$ 及 $x_j^- \ge 0$。其背后的原理在于，任何实数皆可写成两个非负数之差。

(b) **消除不等式约束**：对于形式为

$$
\sum_{j=1}^n a_{ij}x_j \le b_i
$$

的不等式约束，我们引入一个新变量 $s_i$，并将约束写为如下标准型：

$$
\begin{aligned}
\sum_{j=1}^n a_{ij}x_j + s_i &= b_i, \\
s_i &\ge 0.
\end{aligned}
$$

此类变量 $s_i$ 称为**松弛变量**（slack variable）。同理，对于 $\sum_{j=1}^n a_{ij}x_j \ge b_i$ 形式的不等式约束，亦可通过引入**剩余变量**（surplus variable）$s_i$ 及约束 $\sum_{j=1}^n a_{ij}x_j - s_i = b_i, \ s_i \ge 0$ 将其化为标准型。

综上所述，一般问题皆可化为标准型。因此，我们仅需开发求解标准型问题的方法即可。

**例 1.4** 考虑如下问题：

$$
\begin{aligned}
& \text{minimize} & 2x_1 + 4x_2 & \\
& \text{subject to} & x_1 + x_2 & \ge 3 \\
& & 3x_1 + 2x_2 & = 14 \\
& & x_1 \quad\quad & \ge 0,
\end{aligned}
$$

其等价于如下标准型问题：

$$
\begin{aligned}
& \text{minimize} & 2x_1 + 4x_2^+ - 4x_2^- & \\
& \text{subject to} & x_1 + x_2^+ - x_2^- - x_3 & = 3 \\
& & 3x_1 + 2x_2^+ - 2x_2^- \quad\quad & = 14 \\
& & x_1, x_2^+, x_2^-, x_3 & \ge 0.
\end{aligned}
$$

例如，给定原问题的一个可行解 $(x_1, x_2) = (6, -2)$，我们可得标准型问题的可行解 $(x_1, x_2^+, x_2^-, x_3) = (6, 0, 2, 1)$，且两者成本相同。反之，给定标准型问题的可行解 $(x_1, x_2^+, x_2^-, x_3) = (8, 1, 6, 0)$，我们亦可得原问题的可行解 $(x_1, x_2) = (8, -5)$，成本依然相同。

后文中，我们将常以一般形式 $\mathbf{Ax} \ge \mathbf{b}$ 来阐述线性规划理论。然而，在涉及算法（特别是单纯形法与内点法）时，我们将聚焦于标准型 $\mathbf{Ax} = \mathbf{b}, \mathbf{x} \ge \mathbf{0}$，因其在计算上更为便易。

## **1.2 线性规划问题举例**

在本节中，我们将探讨若干线性规划问题的实例。我们的目的之一，是展示线性规划有着极为广泛的适用场景。另一目的，则是帮助读者熟悉那门将定义松散的优化问题构建为数学模型的艺术。

### **生产问题**

某企业利用 $m$ 种不同的原料，生产 $n$ 种不同的产品。令 $b_i$ ($i = 1, \dots, m$) 表示第 $i$ 种原料的现有存量。生产单位第 $j$ 种产品 ($j = 1, \dots, n$)，需消耗 $a_{ij}$ 单位的第 $i$ 种原料，并产生 $c_j$ 的收益。该企业面临的问题是：如何确定每种产品的产量，以使总收益最大化。

本例中，决策变量的选取显而易见。令 $x_j$ ($j = 1, \dots, n$) 表示第 $j$ 种产品的产量。于是，该企业的生产问题可建模如下：

$$
\begin{aligned}
& \text{maximize} & c_1 x_1 + \cdots + c_n x_n & \\
& \text{subject to} & a_{i1} x_1 + \cdots + a_{in} x_n & \le b_i, \quad & i = 1, \dots, m, \\
& & x_j & \ge 0, \quad & j = 1, \dots, n.
\end{aligned}
$$

### **计算机厂商的生产规划**

此处探讨之例，源于数字设备公司（DEC）在 1988 年第四季度的亲身遭遇。此例不仅揭示了现实应用的错综复杂与变幻莫测，更彰显了数学建模在制定重大战略决策时的实用价值。

1988 年二季度，DEC 推出了一系列全新的（单 CPU）计算机系统与工作站。其中，GP-1、GP-2 和 GP-3 为通用计算机系统，在内存、磁盘存储及扩展能力上各不相同；WS-1 和 WS-2 则为工作站。表 1.1 列出了各型号的标价、单机平均磁盘用量及内存用量。譬如，GP-1 需使用 4 块 256K 内存板，且每生产 10 台，平均有 3 台配有磁盘驱动器（即 0.3 的平均用量）。


| 系统型号 (System) | 价格 (Price) | 磁盘驱动器数量 (# disk drives) | 256K 内存板数量 (# 256K boards) |
| :---------------- | :----------- | :----------------------------- | :------------------------------ |
| **GP-1**          | $60,000      | 0.3                            | 4                               |
| **GP-2**          | $40,000      | 1.7                            | 2                               |
| **GP-3**          | $30,000      | 0                              | 2                               |
| **WS-1**          | $30,000      | 1.4                            | 2                               |
| **WS-2**          | $15,000      | 0                              | 1                               |

**表 1.1：DEC 五种不同系统的特性**

该系列新品于第三季度开始发货，并在第四季度缓慢增量。然而，预计下一季度将面临如下困境：

(a) 受调试问题所限，内部 CPU 供应商最多仅能提供 7,000 套。
(b) 磁盘驱动器的供应尚存变数，制造商预估其供应量在 3,000 至 7,000 台之间。
(c) 256K 内存板的供应同样受限，数量介于 8,000 至 16,000 块之间。

在需求方面，市场部确立了 1989 年第一季度的最大需求量：GP-1 系统为 1,800 台，GP-3 系统为 300 台，GP 全系列总计 3,800 台，WS 系列总计 3,200 台。上述预测包含了已接获并须在下一季度交付的订单：GP-2 为 500 台，WS-1 为 500 台，WS-2 为 400 台。

在前几个季度，为应对磁盘驱动器短缺，DEC 采取了如下生产策略：GP-1、GP-3 和 WS-2 不配磁盘驱动器（尽管每 10 位 GP-1 客户中有 3 位希望配置），而 GP-2 和 WS-1 仅配 1 个磁盘驱动器。我们将这种系统配置方式称为**受限生产模式** (constrained mode of production)。

此外，DEC 可通过在 GP-1 系统中使用 2 块替代存储板来取代 4 块 256K 内存板，以此缓解 256K 内存板的短缺。DEC 下一季度可提供 4,000 块替代板。

制造部门清楚地意识到问题已变得错综复杂，营收、利润及客户满意度皆面临风险。如下决策亟待制定：

(a) 1989 年第一季度的生产计划。
(b) 关于磁盘驱动器的使用，DEC 应继续沿用受限模式生产，还是计划满足客户偏好？
(c) 关于内存板，DEC 是否应在其 GP-1 系统中使用替代内存板？
(d) 最后一项决策事关磁盘驱动器短缺与 256K 内存板短缺之间的权衡。制造人员希望集中精力缓解磁盘短缺或 256K 内存板短缺（二者选一）。因此，他们想知道哪一种选择对营收的影响更大。

为了对 DEC 面临的问题进行建模，我们引入变量 $x_1, x_2, x_3, x_4, x_5$，分别代表下一季度计划生产的 GP-1, GP-2, GP-3, WS-1, 和 WS-2 系统的数量（单位：千台）。严格来说，由于 $1000x_i$ 代表产品台数，它必须是整数。这可以通过保留 $x_i$ 小数点后三位（即截断后续小数）来实现；考虑到需求规模以及变量 $x_i$ 的量级，这种取整造成的影响微乎其微，因此可以忽略 $1000x_i$ 的整数约束。

DEC 面临着两项截然不同的决策：其一，在磁盘驱动器的使用上是否采用受限生产模式；其二，对于 GP-1 系统是否使用替代内存板。这导致了四种可能的决策组合。

首先，针对**不使用**替代内存板且**采用**受限磁盘生产模式的情形，我们建立如下模型：

$$
\text{最大化} \quad 60x_1 + 40x_2 + 30x_3 + 30x_4 + 15x_5 \quad (\text{总营收})
$$

满足下列约束：

$$
\begin{aligned}
x_1 + x_2 + x_3 + x_4 + x_5 & \le 7 & & (\text{CPU 供应量}) \\
4x_1 + 2x_2 + 2x_3 + 2x_4 + x_5 & \le 8 & & (\text{256K 内存供应量}) \\
x_2 \quad\quad + x_4 \quad\quad & \le 3 & & (\text{磁盘驱动器供应量}) \\
x_1 \quad\quad\quad\quad\quad\quad\quad\quad & \le 1.8 & & (\text{GP-1 最大需求}) \\
x_3 \quad\quad\quad\quad & \le 0.3 & & (\text{GP-3 最大需求}) \\
x_1 + x_2 + x_3 \quad\quad\quad\quad & \le 3.8 & & (\text{GP 系列最大需求}) \\
x_4 + x_5 & \le 3.2 & & (\text{WS 系列最大需求}) \\
x_2 \quad\quad\quad\quad\quad\quad & \ge 0.5 & & (\text{GP-2 最小需求}) \\
x_4 \quad\quad & \ge 0.5 & & (\text{WS-1 最小需求}) \\
x_5 & \ge 0.4 & & (\text{WS-2 最小需求}) \\
x_1, x_2, x_3, x_4, x_5 & \ge 0. & &
\end{aligned}
$$

请注意，目标函数的单位是百万美元。从某些方面看，这是一个**悲观**的建模，因为 256K 内存和磁盘驱动器的供应量分别被设定为 8 和 3，这是预估范围的下限。实际上，考察当 256K 内存供应量在 8 到 16 之间变化、磁盘供应量在 3 到 7 之间变化时该问题的解，是很有意义的，因为这能提供关于最优解对供应量**敏感性**的宝贵信息。而在另一方面，该建模又是**乐观**的，例如，它假设只要 $x_1 \le 1.8$，GP-1 系统带来的收入就是 $60x_1$，尽管实际上 1,800 台 GP-1 的需求并非板上钉钉。

为了涵盖 DEC 拥有的其他三种选择，部分约束条件需做如下修改。若我们对磁盘驱动器采用**非受限**生产模式，则约束 $x_2 + x_4 \le 3$ 需替换为：

$$
0.3x_1 + 1.7x_2 + 1.4x_4 \le 3.
$$

此外，若我们希望在 GP-1 系统中使用**替代内存板**，则需将约束 $4x_1 + 2x_2 + 2x_3 + 2x_4 + x_5 \le 8$ 替换为以下两个约束：

$$
\begin{aligned}
2x_1 \quad\quad\quad\quad\quad\quad & \le 4, \\
2x_2 + 2x_3 + 2x_4 + x_5 & \le 8.
\end{aligned}
$$

这四种选择的组合，引出了四个各异的线性规划问题。由于如前所述，部分约束条件右端项的确切数值尚不可知，仅知其处于一定范围内，因此对于这每一个问题，都需针对多种参数取值分别求解。

第 5 章将专门探讨当特定参数发生变动时求解线性规划问题的方法，届时我们将重访这一案例。


### **电力产能的多阶段规划**

某州欲规划未来 $T$ 年的电力产能。该州掌握了第 $t=1,\dots,T$ 年期间的电力需求预测值 $d_t$（兆瓦），并假定其准确无误。现有的产能主要源自燃油电厂，这些电厂将不会退役，且在第 $t$ 年的可用产能为 $e_t$。目前有两种扩充电力产能的备选方案：燃煤电厂或核能电厂。若燃煤产能于第 $t$ 年年初投入运营，其每兆瓦的资本成本为 $c_t$。核能电厂相应的资本成本则为 $n_t$。出于各种政治与安全因素的考量，已决定核能在总产能中的占比不得超过 20%。此外，燃煤电厂的使用寿命为 20 年，而核能电厂的使用寿命为 15 年。我们的目标是制定一个成本最低的产能扩张计划。

将此问题构建为线性规划问题，第一步是定义决策变量。令 $x_t$ 和 $y_t$ 分别表示在第 $t$ 年年初投入运营的燃煤（及核能）产能数量。令 $w_t$ 和 $z_t$ 分别表示第 $t$ 年可用的燃煤（及核能）总产能。因此，产能扩张计划的总成本为：

$$
\sum_{t=1}^T (c_t x_t + n_t y_t).
$$

鉴于燃煤电厂的使用寿命为 20 年，我们有：

$$
w_t = \sum_{s=\max\{1, t-19\}}^t x_s, \quad t=1, \dots, T.
$$

同理，对于核能电厂：

$$
z_t = \sum_{s=\max\{1, t-14\}}^t y_s, \quad t=1, \dots, T.
$$

由于可用产能必须满足预测的需求，我们要求：

$$
w_t + z_t + e_t \ge d_t, \quad t=1, \dots, T.
$$

最后，鉴于核能在总产能中的占比不得超过 20%，我们有：

$$
\frac{z_t}{w_t + z_t + e_t} \le 0.2,
$$

这可写为：

$$
0.8z_t - 0.2w_t \le 0.2e_t.
$$

综上所述，该产能扩张问题可表述如下：

$$
\begin{aligned}
& \text{极小化} & \sum_{t=1}^T (c_t x_t + n_t y_t) & \\
& \text{满足} & w_t - \sum_{s=\max\{1, t-19\}}^t x_s & = 0, \quad & t=1, \dots, T, \\
& & z_t - \sum_{s=\max\{1, t-14\}}^t y_s & = 0, \quad & t=1, \dots, T, \\
& & w_t + z_t & \ge d_t - e_t, \quad & t=1, \dots, T, \\
& & 0.8z_t - 0.2w_t & \le 0.2e_t, \quad & t=1, \dots, T, \\
& & x_t, y_t, w_t, z_t & \ge 0, \quad & t=1, \dots, T.
\end{aligned}
$$

我们需要指出，这一建模并非完全符合现实，因为它忽略了可能偏向于大型电厂的某些规模经济效应。然而，它能为真实成本提供一个概略的估算。

### **排班问题**

在前述几个例子中，决策变量的选取均相当直观。现在我们来探讨一个决策变量选取不那么显而易见的例子。

一家医院打算为护士制定每周的夜班（晚 12 点至早 8 点）排班表。第 $j$ 天夜班所需的护士人数为整数 $d_j$ ($j = 1, \dots, 7$)。每位护士需连续上 5 天夜班。问题在于：医院至少需要雇佣多少名护士？

人们可能会尝试使用决策变量 $y_j$ 来表示第 $j$ 天上班的护士人数。然而，若采用此定义，我们将无法刻画“每位护士需连续工作 5 天”这一约束。有鉴于此，我们另辟蹊径，将决策变量 $x_j$ 定义为**在第 $j$ 天开始其工作周**的护士人数。（例如，若某护士的工作周始于第 5 天，则她将在第 5、6、7、1、2 天工作。）于是，该问题可建模如下：

$$
\begin{aligned}
& \text{极小化} & x_1 + x_2 + x_3 + x_4 + x_5 + x_6 + x_7 & \\
& \text{满足} & x_1 \quad\quad\quad\quad + x_4 + x_5 + x_6 + x_7 & \ge d_1 \\
& & x_1 + x_2 \quad\quad\quad\quad + x_5 + x_6 + x_7 & \ge d_2 \\
& & x_1 + x_2 + x_3 \quad\quad\quad\quad + x_6 + x_7 & \ge d_3 \\
& & x_1 + x_2 + x_3 + x_4 \quad\quad\quad\quad + x_7 & \ge d_4 \\
& & x_1 + x_2 + x_3 + x_4 + x_5 \quad\quad\quad\quad & \ge d_5 \\
& & \quad\quad x_2 + x_3 + x_4 + x_5 + x_6 \quad\quad & \ge d_6 \\
& & \quad\quad\quad\quad x_3 + x_4 + x_5 + x_6 + x_7 & \ge d_7 \\
& & x_j \ge 0, \quad x_j \text{ 为整数}.
\end{aligned}
$$

若非存在 $x_j$ 必须为整数这一约束，这便是一个普通的线性规划问题。实际上，这是一个**线性整数规划**问题。处理此问题的一种方法是忽略（“松弛”）整数约束，从而得到所谓的原问题之**线性规划松弛**。由于线性规划松弛的约束更少，选择空间更大，故其最优成本将小于或等于原问题的最优成本。如果线性规划松弛的最优解恰好是整数，那么它同时也是原问题的最优解。若非整数，我们可以将每个 $x_j$ 向上取整，从而得到原问题的一个可行解（尽管未必是最优解）。事实证明，对于这个特定问题，找到最优解并不费力。然而，这只是特例而非通则：求解一般整数规划问题的最优解通常颇为困难；相关方法将在第 11 章中讨论。

### **通信网络中的路径选择**

考虑一个由 $n$ 个节点组成的通信网络，各节点间通过通信链路相连。若链路允许从节点 $i$ 向节点 $j$ 进行单向传输，则用有序对 $(i, j)$ 表示。令 $\mathcal{A}$ 为所有此类链路的集合。假定每条链路 $(i, j) \in \mathcal{A}$ 的传输容量上限为每秒 $u_{ij}$ 比特。此外，沿该链路每传输 1 比特数据，需支付正的费用 $c_{ij}$。

每个节点 $k$ 以每秒 $b^{k\ell}$ 比特的速率生成数据，这些数据需传输至节点 $\ell$。传输方式既可是直接通过链路 $(k, \ell)$，亦可是经过一连串链路的中转。问题的核心在于选择路径，确保所有数据均能抵达其既定目的地，并使总成本降至最低。我们允许具有相同起点（源）和终点（目的地）的数据被拆分，并通过不同的路径进行传输。

为将此问题构建为线性规划模型，我们引入变量 $x_{ij}^{k\ell}$，表示经由链路 $(i, j)$ 传输的、源自节点 $k$ 且流向节点 $\ell$ 的数据量。令

$$
b_i^{k\ell} = \begin{cases}
b^{k\ell}, & \text{若 } i = k, \\
-b^{k\ell}, & \text{若 } i = \ell, \\
0, & \text{其他情况}.
\end{cases}
$$

因此，$b_i^{k\ell}$ 表示在节点 $i$ 处，源自 $k$ 且去往 $\ell$ 的数据从网络外部进入的净流入量（net inflow）。于是，我们得到如下规划形式：

$$
\begin{aligned}
& \text{极小化} & \sum_{(i,j) \in \mathcal{A}} \sum_{k=1}^n \sum_{\ell=1}^n c_{ij} x_{ij}^{k\ell} & \\
& \text{满足} & \sum_{\{j \mid (i,j) \in \mathcal{A}\}} x_{ij}^{k\ell} - \sum_{\{j \mid (j,i) \in \mathcal{A}\}} x_{ji}^{k\ell} & = b_i^{k\ell}, \quad & i, k, \ell = 1, \dots, n, \\
& & \sum_{k=1}^n \sum_{\ell=1}^n x_{ij}^{k\ell} & \le u_{ij}, \quad & (i, j) \in \mathcal{A}, \\
& & x_{ij}^{k\ell} & \ge 0, \quad & (i, j) \in \mathcal{A}, \ k, \ell = 1, \dots, n.
\end{aligned}
$$

第一个约束是针对源 $k$ 去往 $\ell$ 的数据在节点 $i$ 处的流量守恒约束。表达式

$$
\sum_{\{j \mid (i,j) \in \mathcal{A}\}} x_{ij}^{k\ell}
$$

代表源与目的地分别为 $k$ 和 $\ell$ 的数据中，沿某条链路**离开**节点 $i$ 的总量。而表达式

$$
\sum_{\{j \mid (j,i) \in \mathcal{A}\}} x_{ji}^{k\ell}
$$

则代表具有相同源与目的地的数据中，通过某条链路**进入**节点 $i$ 的总量。最后，$b_i^{k\ell}$ 是此类数据从网络外部**进入**节点 $i$ 的净流量。

第二个约束表明，流经链路 $(i, j)$ 的总流量（即所有不同源-宿对的数据流之和）不得超过该链路的容量上限。

此问题即著名的**多商品流问题** (multicommodity flow problem)，其中对应每一个“源-宿”对的流量被视为一种不同的“商品”。若考虑某运输公司欲通过网络将多种商品从各自产地运往销地，便会引出一个在数学上与之相似的问题。

该问题还有一个版本，称为**最小费用网络流问题** (minimum cost network flow problem)，在其中我们不区分不同的商品。取而代之的是，给定每个节点 $i$ 处的外部供给量或需求量 $b_i$，目标是以最小的成本将物资从供给节点运送至需求节点。网络流问题是第 7 章的主题，其特例包含了一些重要问题，诸如最短路问题、最大流问题以及指派问题等。

### **模式分类 (Pattern classification)**

给定 $m$ 个物体样本。对于每个样本（设为第 $i$ 个），均以 $n$ 维向量 $\mathbf{a}_i$ 描述其特征。这些物体分属两类，且已知每个样本的类别归属。

具体而言，不妨假设每个物体皆为苹果或橘子（此即两类）的图像。在此情境下，可用一个三维特征向量 $\mathbf{a}_i$ 来概括第 $i$ 张图像的内容。$\mathbf{a}_i$ 的三个分量（即特征）可分别代表该物体的椭圆率、果柄长度及其按某种量表测得的颜色。我们的目标是设计一个分类器，当面对一个新物体（非原始样本）时，能判断其为苹果还是橘子。

**线性分类器**（linear classifier）由一个 $n$ 维向量 $\mathbf{x}$ 和一个标量 $x_{n+1}$ 定义，其运作方式如下：给定一个特征向量为 $\mathbf{a}$ 的新物体，若满足

$$ \mathbf{a}'\mathbf{x} \ge x_{n+1}, $$

分类器即判定其属于第一类；若满足

$$ \mathbf{a}'\mathbf{x} < x_{n+1}, $$

则判定其属于第二类。

换言之，线性分类器是基于各特征的线性组合来做出决策的。我们的目标是利用现有样本，设计出一个“优良”的线性分类器。

解决此问题的方法繁多，但一个合理的切入点是：要求分类器必须对所有现有样本给出正确分类。设 $S$ 为第一类样本的集合。于是，我们要寻找满足如下约束的 $\mathbf{x}$ 与 $x_{n+1}$：

$$
\begin{aligned}
\mathbf{a}_i'\mathbf{x} &\ge x_{n+1}, \quad & i \in S, \\
\mathbf{a}_i'\mathbf{x} &< x_{n+1}, \quad & i \notin S.
\end{aligned}
$$

值得注意的是，第二组约束涉及严格不等式，这与线性规划通常处理的形式不尽相同。但这并非无法解决：我们观察到，若存在某组 $\mathbf{x}$ 和 $x_{n+1}$ 满足上述所有约束，那么必存在另一组解（通过将 $\mathbf{x}$ 和 $x_{n+1}$ 乘以某个足够大的正标量而得），能够满足：

$$
\begin{aligned}
\mathbf{a}_i'\mathbf{x} &\ge x_{n+1}, \quad & i \in S, \\
\mathbf{a}_i'\mathbf{x} &\le x_{n+1} - 1, \quad & i \notin S.
\end{aligned}
$$

综上所述，寻找一个与所有现有样本相容的线性分类器，本质上就是寻找线性规划问题的一个可行解。

## **1.3 分段线性凸目标函数**

上一节的所有算例皆涉及**线性**目标函数。然而，存在一类重要的优化问题，其目标函数虽为非线性，却可转化为线性规划问题来求解；下文将对此进行探讨。

首先，我们需要给出一些定义：

***

### **定义 1.1**

(a) 若对任意 $\mathbf{x}, \mathbf{y} \in \Re^n$ 及任意 $\lambda \in [0, 1]$，均有
$$ f(\lambda\mathbf{x} + (1 - \lambda)\mathbf{y}) \le \lambda f(\mathbf{x}) + (1 - \lambda)f(\mathbf{y}), $$
则称函数 $f: \Re^n \mapsto \Re$ 为**凸函数** (convex)。

(b) 若对任意 $\mathbf{x}, \mathbf{y} \in \Re^n$ 及任意 $\lambda \in [0, 1]$，均有
$$ f(\lambda\mathbf{x} + (1 - \lambda)\mathbf{y}) \ge \lambda f(\mathbf{x}) + (1 - \lambda)f(\mathbf{y}), $$
则称函数 $f: \Re^n \mapsto \Re$ 为**凹函数** (concave)。

***

注意，若 $\mathbf{x}$ 与 $\mathbf{y}$ 为 $\Re^n$ 中的向量，且 $\lambda$ 在 $[0, 1]$ 区间内取值，则形如 $\lambda\mathbf{x} + (1 - \lambda)\mathbf{y}$ 的点均属于连接 $\mathbf{x}$ 与 $\mathbf{y}$ 的线段。凸函数的定义考察的是：当自变量沿着该线段移动时 $f$ 的取值情况。若 $f$ 为线性函数，定义中的不等式将取等号。因此，该不等式意味着：若将关注点局限于此线段，则函数图像位于相应线性函数图像的下方（或不高于后者）；参见图 1.1(a)。

易见，函数 $f$ 为凸函数当且仅当函数 $-f$ 为凹函数。值得注意，形如 $f(\mathbf{x}) = a_0 + \sum_{i=1}^n a_i x_i$ 的函数（其中 $a_0, \dots, a_n$ 为标量）称为**仿射函数** (affine function)，它既是凸函数也是凹函数。（事实上，仿射函数是唯一既凸且凹的函数。）凸函数（以及凹函数）在优化领域扮演着核心角色。

若 $\mathbf{x}$ 邻域内的所有 $\mathbf{y}$ 均满足 $f(\mathbf{x}) \le f(\mathbf{y})$，则称向量 $\mathbf{x}$ 为 $f$ 的**局部极小值点** (local minimum)。若对所有 $\mathbf{y}$ 均满足 $f(\mathbf{x}) \le f(\mathbf{y})$，则称 $\mathbf{x}$ 为**全局极小值点** (global minimum)。凸函数不会存在非全局极小值的局部极小值点（参见图 1.1），这一性质对于设计高效的优化算法大有裨益。

设 $\mathbf{c}_1, \dots, \mathbf{c}_m$ 为 $\Re^n$ 中的向量，$d_1, \dots, d_m$ 为标量，并考虑由下式定义的函数 $f: \Re^n \mapsto \Re$：
$$ f(\mathbf{x}) = \max_{i=1,\dots,m} (\mathbf{c}_i'\mathbf{x} + d_i) $$
参见图 1.2(a)。基于以下结论，可知此类函数为凸函数。

***

### **定理 1.1** 

设 $f_1, \dots, f_m: \Re^n \mapsto \Re$ 为凸函数。则由 $f(\mathbf{x}) = \max_{i=1,\dots,m} f_i(\mathbf{x})$ 定义的函数 $f$ 亦为凸函数。

***

**证明**：设 $\mathbf{x}, \mathbf{y} \in \Re^n$ 且 $\lambda \in [0, 1]$。我们有
$$
\begin{aligned}
f(\lambda\mathbf{x} + (1 - \lambda)\mathbf{y}) &= \max_{i=1,\dots,m} f_i(\lambda\mathbf{x} + (1 - \lambda)\mathbf{y}) \\
&\le \max_{i=1,\dots,m} (\lambda f_i(\mathbf{x}) + (1 - \lambda)f_i(\mathbf{y})) \\
&\le \max_{i=1,\dots,m} \lambda f_i(\mathbf{x}) + \max_{i=1,\dots,m} (1 - \lambda)f_i(\mathbf{y}) \\
&= \lambda f(\mathbf{x}) + (1 - \lambda)f(\mathbf{y}). \quad \square
\end{aligned}
$$

形如 $\max_{i=1,\dots,m} (\mathbf{c}_i'\mathbf{x} + d_i)$ 的函数称为**分段线性凸函数** (piecewise linear convex function)。一个简单的例子是由 $f(x) = |x| = \max\{x, -x\}$ 定义的绝对值函数。如图 1.2(b) 所示，分段线性凸函数可用于逼近一般凸函数。

现考察线性规划的一种推广，其目标函数为分段线性凸函数而非线性函数：

$$
\begin{aligned}
& \text{极小化} & \max_{i=1,\dots,m} (\mathbf{c}_i'\mathbf{x} + d_i) & \\
& \text{满足} & \mathbf{Ax} \ge \mathbf{b}. &
\end{aligned}
$$

**图 1.1**: (a) 凸函数定义的图示。(b) 凹函数。(c) 既非凸也非凹的函数；注意 $A$ 是局部极小值点，但非全局极小值点。

**图 1.2**: (a) 单变量的分段线性凸函数。(b) 用分段线性凸函数逼近凸函数。

注意，$\max_{i=1,\dots,m} (\mathbf{c}_i'\mathbf{x} + d_i)$ 等于满足“对所有 $i$ 均有 $z \ge \mathbf{c}_i'\mathbf{x} + d_i$”这一条件的最小数 $z$。因此，上述优化问题等价于如下线性规划问题：

$$
\begin{aligned}
& \text{极小化} & z & \\
& \text{满足} & z & \ge \mathbf{c}_i'\mathbf{x} + d_i, \quad i = 1, \dots, m, \\
& & \mathbf{Ax} & \ge \mathbf{b},
\end{aligned}
$$

其中决策变量为 $z$ 和 $\mathbf{x}$。

综上所述，线性规划可用于求解含分段线性凸成本函数的问题，且此类函数可用作更一般凸成本函数的近似。另一方面，这种分段线性近似并非总是良策，因为它可能将光滑函数转化为非光滑函数（分段线性函数具有不连续的导数）。

最后需指出，若给定形式为 $f(\mathbf{x}) \le h$ 的约束，其中 $f$ 为分段线性凸函数 $f(\mathbf{x}) = \max_{i=1,\dots,m} (\mathbf{f}_i'\mathbf{x} + g_i)$，则该约束可改写为
$$ \mathbf{f}_i'\mathbf{x} + g_i \le h, \quad i = 1, \dots, m, $$
从而线性规划依然适用。

### **涉及绝对值的问题**

考虑如下形式的问题：

$$
\begin{aligned}
& \text{极小化} & \sum_{i=1}^n c_i |x_i| & \\
& \text{满足} & \mathbf{Ax} \ge \mathbf{b}, &
\end{aligned}
$$

> 1.3 剩余部分略过

## **1.4 图解法与求解**

本节将通过几个简例，为理解线性规划问题的本质提供有益的几何直观。首例将演示双变量线性规划问题的图解过程。

**例 1.6** 考虑如下问题：

$$
\begin{aligned}
& \text{极小化} & -x_1 - x_2 & \\
& \text{满足} & x_1 + 2x_2 & \le 3 \\
& & 2x_1 + x_2 & \le 3 \\
& & x_1, x_2 & \ge 0.
\end{aligned}
$$

可行集即图 1.3 中的阴影区域。为求最优解，我们按如下步骤进行：对于任意给定标量 $z$，考察所有成本 $\mathbf{c}'\mathbf{x}$ 等于 $z$ 的点集；这便是一条由方程 $-x_1 - x_2 = z$ 描述的直线。注意，该直线垂直于向量 $\mathbf{c} = (-1, -1)$。$z$ 值不同，直线亦不同，但所有直线彼此平行。

具体而言，增大 $z$ 值，对应于将直线 $z = -x_1 - x_2$ 沿向量 $\mathbf{c}$ 的方向平移。由于我们的目标是极小化 $z$，故应尽可能沿 $-\mathbf{c}$ 的方向移动该直线，前提是不脱离可行域。我们所能达到的极限是 $z = -2$（见图 1.3），此时向量 $\mathbf{x} = (1, 1)$ 即为最优解。请注意，此点位于可行集的一个“角”（corner）上。（关于“角”的正式定义将在第 2 章给出。）

对于三维问题，上述方法依然适用，区别仅在于：具有相同成本值 $\mathbf{c}'\mathbf{x}$ 的点集不再是直线，而是平面。该平面同样垂直于向量 $\mathbf{c}$，而我们的目标是在不脱离可行集的前提下，尽可能沿 $-\mathbf{c}$ 的方向平移（滑动）该平面。

**例 1.7** 设可行集为单位立方体，由约束 $0 \le x_i \le 1, i = 1, 2, 3$ 描述，且 $\mathbf{c} = (-1, -1, -1)$。此时，向量 $\mathbf{x} = (1, 1, 1)$ 为最优解。最优解再一次恰好位于可行集的一个角上（图 1.4）。

**图 1.3**: 例 1.6 中问题的图解。

**图 1.4**: 例 1.7 中三维线性规划问题的图解。

在前述两个算例中，可行集皆为**有界**（即未延伸至无穷远），且问题均存在唯一的优解。然而情形并非总是如此，下例将展示其他的可能性。

**例 1.8** 考虑由如下约束定义的 $\Re^2$ 中的可行集：

$$
\begin{aligned}
-x_1 + x_2 & \le 1 \\
x_1 & \ge 0 \\
x_2 & \ge 0,
\end{aligned}
$$

如图 1.5 所示。

(a) 对于成本向量 $\mathbf{c} = (1, 1)$，显见 $\mathbf{x} = (0, 0)$ 为唯一最优解。

(b) 对于成本向量 $\mathbf{c} = (1, 0)$，存在**多个**最优解。具体而言，凡形如 $\mathbf{x} = (0, x_2)$ 且满足 $0 \le x_2 \le 1$ 的向量 $\mathbf{x}$ 皆为最优。注意，此时最优解集是有界的。

(c) 对于成本向量 $\mathbf{c} = (0, 1)$，存在多个最优解，即凡形如 $\mathbf{x} = (x_1, 0)$ 且满足 $x_1 \ge 0$ 的向量 $\mathbf{x}$ 皆为最优。在此情形下，最优解集是**无界**的（包含模长可任意大的向量）。

(d) 考虑成本向量 $\mathbf{c} = (-1, -1)$。对于任意可行解 $(x_1, x_2)$，我们总能通过增大 $x_1$ 的值，构造出成本更低的新可行解。因此，不存在最优的可行解。此外，考查 $x_1$ 与 $x_2$ 均不断增大的向量 $(x_1, x_2)$，可得一列成本趋于 $-\infty$ 的可行解。故此，我们称其最优成本为 $-\infty$。

(e) 若施加一额外约束 $x_1 + x_2 \le -2$，显然不存在任何可行解。

**图 1.5**: 例 1.8 中的可行集。对于每一个 $\mathbf{c}$ 的选择，最优解皆是通过沿 $-\mathbf{c}$ 的方向尽可能移动而得。

***

总结从例 1.8 中获得的见解，我们面临如下几种可能性：

(a) 存在唯一的最优解。

(b) 存在多个最优解；在此情形下，最优解集既可能是有界的，也可能是无界的。

(c) 最优成本为 $-\infty$，且无任何可行解为最优解。

(d) 可行集为空。

原则上，还存在另一种可能性：即便问题可行且最优成本非 $-\infty$，最优解却可能不存在。例如，在约束 $x \ge 0$ 下极小化 $1/x$ 的问题便是如此（对于任意可行解，总存在另一个成本更低的解，但最优成本并非 $-\infty$）。本书后文将会看到，在线性规划中绝不会出现这种可能性。

在我们考查过的算例中，若问题至少存在一个最优解，那么在可行集的各个“角”（corners）中便能找到一个最优解。在第 2 章中我们将证明，只要可行集至少拥有一个角，这便是线性规划问题的一个普遍特征。

### **标准型问题的可视化**

我们现探讨一种方法，即便向量 $\mathbf{x}$ 的维数 $n$ 大于 3，仍能对标准型问题进行可视化。欲行此法，缘由在于：当 $n \le 3$ 时，标准型问题的可行集变化寥寥，不足以提供对一般情形的深刻洞见。（反之，若可行集由 $\mathbf{Ax} \ge \mathbf{b}$ 形式的约束所描述，即便 $\mathbf{x}$ 仅为三维，亦能呈现丰富之变化。）

设有一标准型问题，其矩阵 $\mathbf{A}$ 之维数为 $m \times n$。具体而言，决策向量 $\mathbf{x}$ 为 $n$ 维，且存在 $m$ 个等式约束。假定 $m \le n$，且约束 $\mathbf{Ax} = \mathbf{b}$ 迫使 $\mathbf{x}$ 位于一个 $(n - m)$ 维的集合之上。（直观言之，每个约束皆消除了 $\mathbf{x}$ 的一个“自由度”。）若我们“驻足”于该 $(n - m)$ 维集合之上，并忽略与之正交的 $m$ 个维度，则可行集仅受限于线性不等式约束 $x_i \ge 0, i = 1, \dots, n$。尤为值得注意的是，若 $n - m = 2$，可行集便可绘作一个由 $n$ 个线性不等式约束所定义的二维集合。

为阐释此法，考察 $\Re^3$ 中由约束 $x_1 + x_2 + x_3 = 1$ 及 $x_1, x_2, x_3 \ge 0$ 定义的可行集 [图 1.6(a)]，注意此时 $n = 3$ 且 $m = 1$。若我们驻足于由约束 $x_1 + x_2 + x_3 = 1$ 所定义的平面之上，则该可行集呈现为二维空间中的一个三角形。此外，三角形的每一条边均对应于约束 $x_1, x_2, x_3 \ge 0$ 中的一项；见图 1.6(b)。

**图 1.6**: (a) 可行集的 $n$ 维视图。(b) 同一集合的 $(n - m)$ 维视图。

## **1.5 线性代数基础与记号**

本节将概述我们将采用的主要符号约定，并简要回顾后续内容中涉及的线性代数结论。

### **集合论记号**

若 $S$ 为一集合且 $x$ 为 $S$ 之元素，记作 $x \in S$。集合可用形式 $S = \{x \mid x \text{ 满足性质 } P\}$ 来描述，意为所有具备性质 $P$ 的元素之集。有限集 $S$ 的**基数**（cardinality，即元素个数）记为 $|S|$。集合 $S$ 与 $T$ 的**并集**记为 $S \cup T$，**交集**记为 $S \cap T$。我们用 $S \setminus T$ 表示属于 $S$ 但不属于 $T$ 的所有元素之集。

记号 $S \subset T$ 意味着 $S$ 是 $T$ 的**子集**，即 $S$ 的每个元素亦为 $T$ 的元素；特别地，$S$ 可以等于 $T$。若此外还有 $S \neq T$，则称 $S$ 为 $T$ 的**真子集** (proper subset)。我们用 $\emptyset$ 表示**空集**。符号 $\exists$ 与 $\forall$ 分别代表“存在”与“对所有”。

我们用 $\Re$ 表示实数集。对于任意实数 $a$ 和 $b$，闭区间 $[a, b]$ 与开区间 $(a, b)$ 分别定义为：

$$
[a, b] = \{x \in \Re \mid a \le x \le b\},
$$

以及

$$
(a, b) = \{x \in \Re \mid a < x < b\}.
$$

### **向量与矩阵**

一个维度为 $m \times n$ 的**矩阵**是由实数 $a_{ij}$ 构成的阵列：

$$
\mathbf{A} = \begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{bmatrix}.
$$

矩阵一律用**大写粗体**字母表示。若 $\mathbf{A}$ 为矩阵，我们用 $a_{ij}$ 或 $[\mathbf{A}]_{ij}$ 指代其第 $(i, j)$ 个元素。**行向量**即 $m=1$ 的矩阵，**列向量**即 $n=1$ 的矩阵。除非明确说明，否则“向量”一词均指列向量。向量通常用**小写粗体**字母表示。我们用记号 $\Re^n$ 表示所有 $n$ 维向量的集合。对于任意向量 $\mathbf{x} \in \Re^n$，我们用 $x_1, x_2, \dots, x_n$ 表示其分量。因此，

$$
\mathbf{x} = \begin{bmatrix}
x_1 \\
x_2 \\
\vdots \\
x_n
\end{bmatrix}.
$$

即便指代列向量，为了节省篇幅，我们也会使用记号 $\mathbf{x} = (x_1, x_2, \dots, x_n)$。我们用 $\mathbf{0}$ 表示分量全为零的向量。第 $i$ 个**单位向量** $\mathbf{e}_i$ 指的是除第 $i$ 个分量为 1 外、其余分量均为零的向量。

$m \times n$ 矩阵 $\mathbf{A}$ 的**转置** (transpose) $\mathbf{A}'$ 是一个 $n \times m$ 矩阵

$$
\mathbf{A}' = \begin{bmatrix}
a_{11} & a_{21} & \cdots & a_{m1} \\
a_{12} & a_{22} & \cdots & a_{m2} \\
\vdots & \vdots & & \vdots \\
a_{1n} & a_{2n} & \cdots & a_{mn}
\end{bmatrix};
$$

即 $[\mathbf{A}']_{ij} = [\mathbf{A}]_{ji}$。同理，若 $\mathbf{x}$ 为 $\Re^n$ 中的向量，其转置 $\mathbf{x}'$ 为具有相同元素的行向量。

若 $\mathbf{x}$ 和 $\mathbf{y}$ 为 $\Re^n$ 中的两个向量，则

$$
\mathbf{x}'\mathbf{y} = \mathbf{y}'\mathbf{x} = \sum_{i=1}^n x_i y_i.
$$

该量称为 $\mathbf{x}$ 与 $\mathbf{y}$ 的**内积** (inner product)。若两个向量的内积为零，则称它们**正交** (orthogonal)。注意对任意向量 $\mathbf{x}$，$\mathbf{x}'\mathbf{x} \ge 0$，且等号成立当且仅当 $\mathbf{x} = \mathbf{0}$。表达式 $\sqrt{\mathbf{x}'\mathbf{x}}$ 称为 $\mathbf{x}$ 的**欧几里得范数** (Euclidean norm)，记为 $\|\mathbf{x}\|$。**施瓦茨不等式** (Schwartz inequality) 断言：对于任意两个同维向量，我们有

$$
|\mathbf{x}'\mathbf{y}| \le \|\mathbf{x}\| \cdot \|\mathbf{y}\|,
$$

等号成立当且仅当其中一个向量是另一个向量的标量倍。

若 $\mathbf{A}$ 为 $m \times n$ 矩阵，我们用 $\mathbf{A}_j$ 表示其第 $j$ 列，即 $\mathbf{A}_j = (a_{1j}, a_{2j}, \dots, a_{mj})$。（这是我们用小写字母表示向量这一规则的唯一例外。）我们亦用 $\mathbf{a}_i$ 表示由第 $i$ 行元素构成的向量，即 $\mathbf{a}_i = (a_{i1}, a_{i2}, \dots, a_{in})$。因此，

$$
\mathbf{A} = \begin{bmatrix}
| & | & & | \\
\mathbf{A}_1 & \mathbf{A}_2 & \cdots & \mathbf{A}_n \\
| & | & & |
\end{bmatrix}
= \begin{bmatrix}
\text{---} & \mathbf{a}'_1 & \text{---} \\
& \vdots & \\
\text{---} & \mathbf{a}'_m & \text{---}
\end{bmatrix}.
$$

设有两个矩阵 $\mathbf{A}$ 和 $\mathbf{B}$，维数分别为 $m \times n$ 和 $n \times k$。它们的乘积 $\mathbf{AB}$ 是一个 $m \times k$ 矩阵，其元素定义为：

$$
[\mathbf{AB}]_{ij} = \sum_{\ell=1}^n [\mathbf{A}]_{i\ell} [\mathbf{B}]_{\ell j} = \mathbf{a}'_i \mathbf{B}_j,
$$

其中 $\mathbf{a}'_i$ 是 $\mathbf{A}$ 的第 $i$ 行，$\mathbf{B}_j$ 是 $\mathbf{B}$ 的第 $j$ 列。矩阵乘法满足**结合律**（associative），即 $(\mathbf{AB})\mathbf{C} = \mathbf{A}(\mathbf{BC})$；但一般不满足**交换律**（commutative），即等式 $\mathbf{AB} = \mathbf{BA}$ 并不总是成立。我们还有 $(\mathbf{AB})' = \mathbf{B}'\mathbf{A}'$。

设 $\mathbf{A}$ 为 $m \times n$ 矩阵，其列向量为 $\mathbf{A}_i$。于是有 $\mathbf{A}\mathbf{e}_i = \mathbf{A}_i$。任意向量 $\mathbf{x} \in \Re^n$ 皆可写成 $\mathbf{x} = \sum_{i=1}^n x_i \mathbf{e}_i$ 的形式，由此可得

$$
\mathbf{Ax} = \mathbf{A} \sum_{i=1}^n x_i \mathbf{e}_i = \sum_{i=1}^n \mathbf{A}\mathbf{e}_i x_i = \sum_{i=1}^n \mathbf{A}_i x_i.
$$

矩阵与向量的乘积 $\mathbf{Ax}$ 还有另一种表示公式：

$$
\mathbf{Ax} = \begin{bmatrix}
\mathbf{a}'_1 \mathbf{x} \\
\mathbf{a}'_2 \mathbf{x} \\
\vdots \\
\mathbf{a}'_m \mathbf{x}
\end{bmatrix},
$$

其中 $\mathbf{a}'_1, \dots, \mathbf{a}'_m$ 为 $\mathbf{A}$ 的各行。

若矩阵的行数 $m$ 等于列数 $n$，则称其为**方阵**（square matrix）。我们用 $\mathbf{I}$ 表示**单位矩阵**（identity matrix），这是一个对角元均为 1、非对角元均为 0 的方阵。对于任意与 $\mathbf{I}$ 维数相容的矩阵 $\mathbf{A}$ 和 $\mathbf{B}$，单位矩阵满足 $\mathbf{IA} = \mathbf{A}$ 及 $\mathbf{BI} = \mathbf{B}$。

若 $\mathbf{x}$ 为向量，记号 $\mathbf{x} \ge \mathbf{0}$ 和 $\mathbf{x} > \mathbf{0}$ 分别表示 $\mathbf{x}$ 的每个分量均为非负（或均为正）。若 $\mathbf{A}$ 为矩阵，不等式 $\mathbf{A} \ge \mathbf{0}$ 和 $\mathbf{A} > \mathbf{0}$ 亦具有类似含义。

### **矩阵求逆**

设 $\mathbf{A}$ 为方阵。若存在同维方阵 $\mathbf{B}$ 满足 $\mathbf{AB} = \mathbf{BA} = \mathbf{I}$，则称 $\mathbf{A}$ **可逆** (invertible) 或**非奇异** (nonsingular)。此矩阵 $\mathbf{B}$ 称为 $\mathbf{A}$ 的**逆** (inverse)，它是唯一的，记作 $\mathbf{A}^{-1}$。值得注意的是 $(\mathbf{A}')^{-1} = (\mathbf{A}^{-1})'$。此外，若 $\mathbf{A}$ 与 $\mathbf{B}$ 为同维可逆矩阵，则 $\mathbf{AB}$ 亦可逆，且 $(\mathbf{AB})^{-1} = \mathbf{B}^{-1}\mathbf{A}^{-1}$。

给定一组有限个向量 $\mathbf{x}^1, \dots, \mathbf{x}^K \in \Re^n$，若存在不全为零的实数 $a_1, \dots, a_K$ 使得 $\sum_{k=1}^K a_k\mathbf{x}^k = \mathbf{0}$，则称它们**线性相关** (linearly dependent)；否则，称它们**线性无关** (linearly independent)。线性无关的一个等价定义是：向量 $\mathbf{x}^1, \dots, \mathbf{x}^K$ 中没有任何一个向量可表示为其余向量的线性组合（习题 1.18）。我们有如下结论。

***

**定理 1.2** 设 $\mathbf{A}$ 为方阵。则下列陈述等价：

(a) 矩阵 $\mathbf{A}$ 可逆。

(b) 矩阵 $\mathbf{A}'$ 可逆。

(c) $\mathbf{A}$ 的行列式非零。

(d) $\mathbf{A}$ 的行向量线性无关。

(e) $\mathbf{A}$ 的列向量线性无关。

(f) 对任意向量 $\mathbf{b}$，线性系统 $\mathbf{Ax} = \mathbf{b}$ 有唯一解。

(g) 存在某个向量 $\mathbf{b}$，使得线性系统 $\mathbf{Ax} = \mathbf{b}$ 有唯一解。

***

假定 $\mathbf{A}$ 为可逆方阵，系统 $\mathbf{Ax} = \mathbf{b}$ 的解 $\mathbf{x} = \mathbf{A}^{-1}\mathbf{b}$ 可由**克拉默法则** (Cramer's rule) 给出显式公式。具体而言，$\mathbf{x}$ 的第 $j$ 个分量为

$$
x_j = \frac{\det(\mathbf{A}^j)}{\det(\mathbf{A})},
$$

其中 $\mathbf{A}^j$ 是将矩阵 $\mathbf{A}$ 的第 $j$ 列替换为 $\mathbf{b}$ 后所得的矩阵。此处及后文中，记号 $\det(\mathbf{A})$ 均用于表示方阵 $\mathbf{A}$ 的行列式。